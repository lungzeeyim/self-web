---
title: SQL Optimizaiton
tags:
- job
---

1. SQL 优化：
    - 使用`索引`
        - 索引 提高SQL查询性能 最常见和有效的 方法之一。
        - 创建 索引 -> 加快 查询 速度。
        - 索引 加快查询速度 -> 因为提供了 快速的方式 查找 特定值，减少 扫描 整个表 的需求。
    - 避免全表扫描
        - 尽量避免对整个表进行扫描操作，因为这样的操作会消耗大量的时间和资源。
        - 可以通过使用索引、优化查询语句、使用合适的过滤条件等方式来避免全表扫描。
    - 使用JOIN优化查询
        - 当需要在多个表之间 进行连接查询时，应该尽量优化JOIN操作。
        - 可以通过使用合适的JOIN类型、创建合适的索引、使用正确的JOIN顺序等方式来优化JOIN操作。
    - 用 合适的 数据类型
        - 合适的 数据类型 提高 查询的性能
        - 更小的数据类型 减少 存储空间的使用，从而提高查询性能
        - 尽量 避免 在WHERE子句中 值 进行函数操作 / 運算，因为这样会导致索引无效。
            ```java
            -- 索引失效
            SELECT * FROM users WHERE YEAR(create_time) = 2023;
            SELECT * FROM products WHERE price * 1.1 > 100;

            -- 改善寫法
            SELECT * FROM users WHERE create_time BETWEEN '2023-01-01' AND '2023-12-31';
            SELECT * FROM products WHERE price > 100 / 1.1;

            ```
    - 写 高效查询语句
        - 高效的查询语句 提高 SQL性能
        - 避免使用 LIKE %x 通配符 查询等
        - 此外，还可以使用 EXPLAIN语句 来分析 查询执行计划，找出潜在的性能问题。
    - 分析 和 优化表结构
        - 根据数据的访问模式来创建适当的索引
        - 优化
            - 使用分区表
            - 垂直分割表
    - 避免 不必要的 逻辑运算
        - 尽量避免 在查询中 进行复杂的逻辑运算
        - 如OR、NOT等操作。这些操作会增加查询的复杂度，导致性能下降
    - 限制返回结果的数量
        -  如果查询结果集很大，可以考虑限制返回结果的数量。
        -  使用 LIMIT语句 限制 返回行数
        -  或者 使用 分页查询 逐步加载结果
    - 定期进行数据库维护和优化
        - 可以通过定期更新统计信息、紧缩数据库、重建索引等方式来提高数据库的性能。

2. 请说明什么是索引？为什么使用索引？
    - 索引是一种数据结构，用于快速查找和访问数据库中的特定数据
    - 使用索引 可以加快 查询操作的速度
    - 减少了需要扫描整个表的需求。

3. 请解释什么是全表扫描？如何避免全表扫描？
    - 全表扫描 是指 对整个表进行遍历，逐行检查 以找到满足查询条件的记录
    - 避免 全表扫描
        - 使用 过滤条件
        - 创建适当的索引
        - 优化查询语句
        - JOIN操作
        - 使用分区表等方式提高查询效率。

4. 请解释什么是JOIN操作？如何优化JOIN操作？
    - JOIN操作 用于将 多个表中的 相关记录 连接在一起。
    - 优化JOIN操作，可以选择 合适的JOIN类型
        - INNER JOIN
        - LEFT JOIN
        - RIGHT JOIN
5. 解释 查询执行计划？如何 通过 查询执行计划 进行SQL优化？
    - 查询执行计划 是指 查询语句 在数据库中 执行时的 操作顺序和方式
    - by查询执行计划
        - 可以了解到 查询 涉及到的 表
        - 使用的索引
        - JOIN操作等信息
    - 可以用 EXPLAIN语句 来获取查询执行计划
6. 什么是 垂直分割表 和 水平分割表？如何 使用它们 来优化 查询性能？
    - 通过 垂直分割 和 水平分割 可以减少查询时扫描的数据量，从而提高查询性能。
    - 垂直分割表 是将 一个表的列 按照 业务需求 分割 成多个表
        - 每个表 存储 一部分字段信息
    - 水平分割表 是将 一个表的行 按照某些条件 分割成多个表
        - 每个表 存储 符合条件的行。

7. 索引 在以下情况下 可能会失效
    - 表达式不适合索引
        - 当查询中的条件 使用了函数
        - 计算表达式
        - 类型转换
        - 对列进行操作时，索引可能无法被有效使用
    - LIKE操作使用通配符开头
        - 当使用LIKE操作符进行模糊匹配时，如果通配符（如%）出现在搜索模式的开头，索引可能无法使用。
    - 使用OR操作符
        - 当查询中使用了OR操作符 连接多个条件时
            - 如果每个条件涉及的列没有适合的索引，索引可能不会被使用，导致索引失效。
    - 数据不均匀分布
        - 如果索引列上 数据分布 不均匀，即某些值的重复度很高，而其他值的重复度较低，那么索引可能会失效
            - 因为优化器可能认为全表扫描会更高效。
    - 数据量过小：如果表中的数据量很小，优化器可能会认为全表扫描的性能比使用索引更好，导致索引失效。





















